<div class="container">

	<!-- Report datepicker -->
	<div class="row">
		<div class="col-sm-4">

	    <div class="input-group" id="reportDatepickerContainer">
	      <span class="input-group-btn">
	        <button class="btn btn-warning" type="button" id="back">
	        	<%= __('Back') %>
	        </button>
	      </span>
	      <input type="text" class="form-control" id="datepicker">
	      <span class="input-group-btn">
	        <button class="btn btn-success" type="button" id="foward">
	        	<%= __('Foward') %>
	        </button>
	      </span>
	    </div>

		</div>

		<div class="col-sm-3">
			<button id="print" class="btn btn-primary" data-report="/readings/cristallisation/report"><%= __('Print') %></button>
		</div>

	</div>



	<div class="row">
		<div class="col-sm-12">

			<!-- Nav tabs -->
			<ul class="nav nav-tabs" role="tablist">
			  <li class="active"><a href="#stage1train1" role="tab" data-toggle="tab">Stage 1 - Train 1</a></li>
			  <li><a href="#stage2train1" role="tab" data-toggle="tab">Stage 2 - Train 1</a></li>
			</ul>

			<!-- Tab panes -->
			<div class="tab-content" id="reportContainer">
			  <div class="tab-pane active" id="stage1train1">
					<iframe src="" frameborder="0" class="report" data-report="/readings/cristallisation/stage1train1"></iframe>
			  </div>
			  <div class="tab-pane" id="stage2train1">
					<iframe src="" frameborder="0" class="report" data-report="/readings/cristallisation/stage2train1"></iframe>
			  </div>
			</div>



		</div>
	</div>






</div>



<script type="text/javascript">

window.addEventListener('load', function () {

	var today = new Date();


	var datepicker = $('#datepicker').datepicker({
		language: $('#__USER_LOCALE__').val(),
		todayHighlight: true,
		format: 'yyyy-mm-dd',
		autoclose: true,
	})
	.on('changeDate', function (e) {
		var date = e.date;
		show_reports(date);
	})

	datepicker.datepicker('setDate', today);



	$('#back').on('click', function (e) {
		e.preventDefault()
		var currentDate = moment(datepicker.datepicker('getDate'));
		datepicker.datepicker('setDate', new Date(currentDate.subtract(1, 'd').format()));
	})



	$('#foward').on('click', function (e) {
		e.preventDefault()
		var currentDate = moment(datepicker.datepicker('getDate'));
		datepicker.datepicker('setDate', new Date(currentDate.add(1, 'd').format()));
	})


	$('#print').on('click', function (e) {
		e.preventDefault();
		var currentDate = moment(datepicker.datepicker('getDate')).format('YYYY-MM-D') + 'T00:00:00';
		var folder = $(this).attr('data-report');
		var server = 'http://paradevsrv02/ReportServer';
		var options = 'rs:Command=Render';	
		var href = server + '?' + folder + '&' + options + '&lecture=' + currentDate;
		Utils.popupWindow(href, 1200, 700);

	})


	$('.report').on('load', function () {
		$('body').removeClass('loading');
	})

})




function show_reports (date) {

	$('body').addClass('loading');

	var server = 'http://paradevsrv02/ReportServer';
	var options = 'rs:Command=Render&rc:Toolbar=false';
	var formatDate = moment(date).format('YYYY-MM-D') + 'T00:00:00';


	$('.report').each(function (index, report) {
		var folder = $(this).attr('data-report');
		var src = server + '?' + folder + '&' + options + '&lecture=' + formatDate;
		$(this).attr('src', src);
	})



}


</script>